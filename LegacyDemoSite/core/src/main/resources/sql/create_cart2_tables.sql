-- Cart2 관련 테이블 생성 스크립트
-- cart1과 유사한 구조로 cart2용 테이블 생성

-- Cart2 Order 테이블
CREATE TABLE IF NOT EXISTS BLC_ORDER_CART2 (
    ORDER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    ORDER_NUMBER VARCHAR(255),
    CUSTOMER_ID BIGINT,
    NAME VARCHAR(255),
    EMAIL VARCHAR(255),
    PHONE_NUMBER VARCHAR(255),
    SUBTOTAL DECIMAL(19,5),
    TOTAL_SHIPPING DECIMAL(19,5),
    TOTAL_TAX DECIMAL(19,5),
    TOTAL DECIMAL(19,5),
    STATUS VARCHAR(255),
    SUBMIT_DATE TIMESTAMP,
    CART_TYPE VARCHAR(50) DEFAULT 'CART2',
    CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Cart2 Order Item 테이블
CREATE TABLE IF NOT EXISTS BLC_ORDER_ITEM_CART2 (
    ORDER_ITEM_ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    ORDER_ID BIGINT,
    SKU_ID BIGINT,
    PRODUCT_ID BIGINT,
    QUANTITY INT,
    PRICE DECIMAL(19,5),
    SALE_PRICE DECIMAL(19,5),
    RETAIL_PRICE DECIMAL(19,5),
    NAME VARCHAR(255),
    CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ORDER_ID) REFERENCES BLC_ORDER_CART2(ORDER_ID)
);

-- Cart2 Order Item Attribute 테이블
CREATE TABLE IF NOT EXISTS BLC_ORDER_ITEM_ATTRIBUTE_CART2 (
    ORDER_ITEM_ATTRIBUTE_ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    ORDER_ITEM_ID BIGINT,
    NAME VARCHAR(255),
    VALUE VARCHAR(255),
    CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ORDER_ITEM_ID) REFERENCES BLC_ORDER_ITEM_CART2(ORDER_ITEM_ID)
);

-- 인덱스 생성
CREATE INDEX IF NOT EXISTS IDX_ORDER_CART2_CUSTOMER ON BLC_ORDER_CART2(CUSTOMER_ID);
CREATE INDEX IF NOT EXISTS IDX_ORDER_CART2_TYPE ON BLC_ORDER_CART2(CART_TYPE);
CREATE INDEX IF NOT EXISTS IDX_ORDER_ITEM_CART2_ORDER ON BLC_ORDER_ITEM_CART2(ORDER_ID);
CREATE INDEX IF NOT EXISTS IDX_ORDER_ITEM_CART2_PRODUCT ON BLC_ORDER_ITEM_CART2(PRODUCT_ID);
CREATE INDEX IF NOT EXISTS IDX_ORDER_ITEM_ATTR_CART2_ITEM ON BLC_ORDER_ITEM_ATTRIBUTE_CART2(ORDER_ITEM_ID);